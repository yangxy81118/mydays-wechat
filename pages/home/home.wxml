<!--index.wxml-->
<view class="main">
  <view class="tab-nav">
    <view class="nav {{navAllClass}}" bindtap='listNavAction'>
      <text class="icon iconfont icon-all"></text>
      <text class="word">全部</text>
      <view class="underline"></view>
    </view>
    <view class="nav {{navFavorClass}}" bindtap='listNavAction' data-favor="1">
      <text class="icon iconfont icon-star"></text>
      <text class="word">星标</text>
      <view class="underline"></view>
    </view>
    <view class="layout-btn" bindtap='layoutAction'>
      <text class="icon iconfont {{layoutBtnClass}}"></text>
    </view>
    <!-- <image class="star" src="/images/star.png" /> -->
  </view>
  <!--style='height:{{listHeight}}px' -->
  <view wx:if="{{days.length == 0}}" class='empty-list'>
    <image src='/images/empty-list.png' mode='aspectFit'></image>
    
    <view class="sug" wx:if="{{queryFavor}}">
      <text>还没有任何星标日子~</text>
    </view>
    <view class="sug" wx:else>
      <text>还记得爸妈的生日吗?</text>
      <text>记下来吧！</text>
    </view>
  </view>
  <scroll-view wx:else scroll-y='true' class="list">
    <scroll-view wx:if="{{layout == 1}}" scroll-x="true" class="day-item-h" wx:for="{{days}}" wx:for-index="idx" wx:for-item="item">
      <view class="item-scroll-wrap">
        <view class="day-box" bindtap="popupAction" data-dayId="{{item.id}}" data-idx="{{idx}}">
          <text class="day-title ">{{item.name}}{{item.age}}岁生日</text>
          <block wx:if="{{item.remain <= 60}}">
            <text wx:if="{{item.remain == -1}}" class="day-remain close-remain">今天</text>
            <text wx:if="{{item.remain == 0}}" class="day-remain close-remain">明天</text>
            <text wx:if="{{item.remain == 1}}" class="day-remain close-remain">后天</text>
            <text wx:if="{{item.remain > 1}}" class="day-remain close-remain">还有{{item.remain}}天</text>
            <text class="date close-date" wx:if="{{item.lunar.length == 0}}">{{item.month}}月{{item.date}}日</text>
            <text class="date close-date" wx:else>{{item.lunar}}</text>
            <view class="close-tip"></view>
          </block>
          <block wx:else>
            <text class="day-remain">还有{{item.remain}}天</text>
            <text class="date" wx:if="{{item.lunar.length == 0}}">{{item.month}}月{{item.date}}日</text>
            <text class="date" wx:else>{{item.lunar}}</text>
          </block>
          <image class="star" wx:if="{{item.favor}}" src="/images/star-s.png" />
          <view class="new" wx:if="{{item.id == newId }}">
             <text>新</text> 
          </view>
        </view>
        <view class="opt-box">
          <text class="edit iconfont icon-edit" bindtap='editAction' data-dayId='{{item.id}}'></text>
          <text class="del iconfont icon-delete" bindtap='delAction' data-dayId='{{item.id}}'></text>
        </view>
      </view>
    </scroll-view>


    <view wx:if="{{layout == 2}}" wx:for="{{days}}" wx:for-index="idx" wx:for-item="item" 
      bindtap="popupAction" data-dayId="{{item.id}}" data-idx="{{idx}}"
      class="day-item-v">
        <view wx:if="{{item.remain <= 60}}" class="item-v-main close-v" data-dayId="{{item.id}}">
          <text wx:if="{{item.favor}}" class="star iconfont icon-star"></text>

          <text wx:if="{{item.remain == -1}}" class="remain">今天</text>
          <text wx:if="{{item.remain == 0}}" class="remain">明天</text>
          <text wx:if="{{item.remain == 1}}" class="remain">后天</text>
          <text wx:if="{{item.remain > 1}}" class="remain">{{item.remain}}</text>
          <!-- <text class="remain">{{item.remain}}</text> -->

          <text class="name">{{item.name}}</text>
          <text class="disc">{{item.age}}岁生日</text>
          <text class="date">{{item.year}}-{{item.month}}-{{item.date}}</text>
        </view>
        <view wx:else class="item-v-main" data-dayId="{{item.id}}">
          <text wx:if="{{item.favor}}" class="star iconfont icon-star"></text>
          <text class="remain">{{item.remain}}</text>
          <text class="name">{{item.name}}</text>
          <text class="disc">{{item.age}}岁生日</text>
          <text wx:if="{{item.lunar.length == 0}}" class="date">{{item.year}}-{{item.month}}-{{item.date}}</text>
          <text wx:else class="date">{{item.lunar}}</text>
        </view>
        <view class="new" wx:if="{{item.id == newId }}" >
            <text>新</text> 
        </view>
    </view>

    <view class="bottom-box"></view>

  </scroll-view>

  <view class="bottom-mask"></view>

  <button wx:if="{{!isFull}}" class="add" bindtap='addAction'>记录生日</button>
  <button wx:else class="add disable">额度已满</button>

  <!-- <navigator  url='/pages/edit/edit'></navigator>
  <navigator wx:else class="add disable" bindtap="fullAction">额度已满</navigator> -->

</view>


<view class="model-bk" style="display:{{modelShow}}" bindtap='modelTapAction' id="popBk">
  <view class="main" id="popContent" catchtap='modelTapAction'>

    <view class="content">
      <block wx:if="{{popUpDay.remain < 2}}">
        <text wx:if="{{popUpDay.remain == -1}}" class="remain orange special">今天</text>
        <text wx:if="{{popUpDay.remain == 0}}" class="remain orange special">明天</text>
        <text wx:if="{{popUpDay.remain == 1}}" class="remain orange special">后天</text>
        <text class="name">{{popUpDay.name}}</text>
        <text class="birthday">{{popUpDay.age}}岁生日</text>
      </block>
      <block wx:else>
          <text class="small">距离</text>
          <text class="name">{{popUpDay.name}}</text>
          <text class="birthday">{{popUpDay.age}}岁生日</text>
          <text class="small">还有</text> 
          <text wx:if="{{popUpDay.remain <= 60 }}" class="remain orange">{{popUpDay.remain}}天</text>
          <text wx:else class="remain">{{popUpDay.remain}}天</text>
      </block>
      
      <view class="greeting">
        <text class="greeting">{{popUpDay.greeting}}</text>
      </view>

    </view>


    <view class="toolBar">
      <navigator url="/pages/edit/edit?dayId={{popUpDay.id}}" class="icon iconfont icon-edit"></navigator>
      <!-- <navigator class="icon iconfont icon-fenxiang" catchtap='shareAction'></navigator> -->
      <navigator class="icon iconfont icon-delete red" data-dayId="{{popUpDay.id}}" bindtap='delAction'></navigator>
    </view>
    <text wx:if="{{popUpDay.remain <= 60}}" class="highLight hl"></text>
    <text wx:else class="highLight"></text>

   
  </view>
  <view wx:if="{{popUpIdx > 0}}" class="seq prev" catchtap='popSeqAction' id="prev"><text class="iconfont icon-last"></text></view>
  <view wx:if="{{popUpIdx+1 < daysCnt}}"class="seq next" catchtap='popSeqAction' id="next"><text class="iconfont icon-next"></text></view>
  <view class="shadow s1"></view> 
  <view class="shadow s2"></view> 
  <!-- <text class="quit" bindtap='quitModel'>×</text> -->
</view>